<!DOCTYPE html>

<head>
  <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="js/winddata.js"></script>
  <script type="text/javascript" src="js/gamestate.js"></script>
  <script type="text/javascript" src="js/settings.js"></script>
  <script type="text/javascript" src="js/controlls.js"></script>
  <script type="text/javascript" src="js/windeditor.js"></script>
  <script type="text/javascript" src="js/game.js"></script>
  <link type="image/x-icon" rel="icon" href="img/favicon.ico" />
  <title>Pentium-Rinrab</title>
  <link href="css/bootstrap.min.css" rel="stylesheet" />
  <style type="text/css">
    body {
      position: fixed;
      overflow: hidden;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    body>* {
      position: unset;
    }

    .game-elem {
      position: absolute;
    }

    .pn-lines {
      width: 500%;
      margin-left: -250%;
      transform-origin: center top;
      transition: all 0.5s ease-in-out;
    }

    #wind {
      transition: all 0.5s ease-in-out;
      width: 50px;
      left: 10px;
    }

    #boats>.game-elem {
      transition: top 0.5s ease-in-out, left 0.5s ease-in-out, rotate 0.2s ease-in-out;
    }

    #game-area>* {
      position: absolute;
    }

    .list-group-item {
      height: 35px;
      font-size: 15px;
    }

    .pn-wind-hide,
    .wind-data-arrow {
      position: absolute;
    }

    .wind-data-arrow {
      height: 50px;
      right: 15px;
      margin-top: -10px;
    }

    .pn-wind-hide {
      height: 15px;
      right: 10px;
    }

    .pn-boat {
      --boat-scale: 1.2;
      width: calc(14px * var(--boat-scale));
      height: calc(20px * var(--boat-scale));
      margin-left: calc(-7px * var(--boat-scale));
      margin-top: calc(-10px * var(--boat-scale));
      transform-origin: center;
    }

    .pn-control-color,
    .pn-control-finish-time {
      border-radius: 4px;
      margin: -5px;
      width: 1.5em;
      height: 1.5em;
      color: white;
    }

    .pn-control-finish-time {
      width: 5em;
      color: black;
    }

    .pn-mark {
      width: 20px;
      height: 20px;
      margin-left: -10px;
      margin-top: -10px;
    }

    #btn-add-player {
      width: auto;
    }

    #back-btn {
      width: 25%;
    }

    #btn-done {
      flex: auto;
    }

    #btn-apply {
      flex: auto;
    }

    #lines-img {
      width: 100%;
    }

    #game-area {
      transform-origin: left top;
      overflow: hidden;
    }

    #game-area svg {
      display: block;
    }

    #game-cont {
      width: 100%;
      height: 100%;
    }

    #btn-nowember {
      width: 3em;
      height: 2em;
    }

    .pn-start-line {
      width: 20px;
      height: 20px;
      position: absolute;
      margin-top: -10px;
    }

    .wind-data-scroller {
      height: 100vh;
      overflow: auto;
    }

    #lines-container {
      height: 200%;
      width: 200%;
      transform-origin: center;
      margin-top: -50%;
      margin-left: -50%;
      transition: all 0.5s ease-in-out;
    }

    #wind-label {
      left: 40px;
      top: 30px;
      font-family: monospace;
      text-align: right;
      width: 100px;
    }

    .start .race-control-header,
    .start .race-controls,
    .start #game-alert,
    .race #start-alert,
    .race #create,
    .race .start-controls,
    .race .start-control-header,
    .race #create,
    .race .start-controls,
    #game-area[data-show-boats="dot"] .boat-full-svg,
    #game-area[data-show-boats="full"] .boat-hidden-svg {
      display: none;
    }

    [data-current-tack="port"] .starboard-forward-btn,
    [data-current-tack="port"] .starboard-tack-btn {
      display: none;
    }

    [data-current-tack="starboard"] .port-forward-btn,
    [data-current-tack="starboard"] .port-tack-btn {
      display: none;
    }

    .icon-sm {
      width: 16px;
      height: 16px;
    }

    .copyright {
      width: 100%;
      bottom: 0px;
      font-size: x-small;
    }

    .finished .race-controls,
    .finished .start-controls {
      display: none;
    }

    .race .finish-controls,
    .start .finish-controls {
      display: none;
    }

    .finished .finish-controls {
      display: flex;
    }
  </style>
</head>

<body class="start">
  <svg xmlns="http://www.w3.org/2000/svg" version="1.1" display="block" height="0">
    <defs>
      <symbol id="icon-starboard-forward" viewBox="0 0 16 16">
        <polyline points="14,14 2,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-width="1.7" />

        <polyline points="3,8 2,2 8,3" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-linecap="round"
          stroke-width="1.7" />

        <ellipse rx="1.8" ry="1.8" cx="14" cy="14" fill="currentColor" />
      </symbol>
      <symbol id="icon-port-forward" viewBox="0 0 16 16">
        <polyline points="2,14 14,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-width="1.7" />

        <polyline points="13,8 14,2 8,3" fill="none" stroke="currentColor" stroke-linejoin="miter"
          stroke-linecap="round" stroke-width="1.7" />

        <ellipse rx="1.8" ry="1.8" cx="2" cy="14" fill="currentColor" />
      </symbol>
      <symbol id="icon-starboard-tack" viewBox="0 0 16 16">
        <polyline points="8,14 2,8 8,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-width="1.7" />

        <polyline points="8,7 9,1 3,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-linecap="round"
          stroke-width="1.7" />
        <ellipse rx="1.8" ry="1.8" cx="8" cy="14" fill="currentColor" />
      </symbol>
      <symbol id="icon-port-tack" viewBox="0 0 16 16">
        <polyline points="8,14 14,8 8,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-width="1.7" />

        <polyline points="8,7 7,1 13,2" fill="none" stroke="currentColor" stroke-linejoin="miter" stroke-linecap="round"
          stroke-width="1.7" />
        <ellipse rx="1.8" ry="1.8" cx="8" cy="14" fill="currentColor" />
      </symbol>
    </defs>
  </svg>
  <div class="row h-100 g-0">
    <div style="width: calc(100vh * 200 / 500); padding: 0;" id="wind-data-container">
      <svg xmlns="http://www.w3.org/2000/svg" id="wind-data-svg" class="h-100"></svg>
    </div>
    <div class="col p-0 position-relative">
      <div id="game-cont" class="position-absolute">
        <div id="game-area" style="position: relative;  height: 100%; width: 100%;">
          <svg viewBox="0 0 1 1" id="background" style="height: 100%;  background-color: #ebeaff;"></svg>
          <div class="copyright">
            <div class="text-center text-muted">
              PENTIUM &copy; Rautu &amp; Rinrab
            </div>
          </div>
          <div id="lines-container">
            <svg id="lines-svg" stroke="gray" class="w-100 h-100" xmlns="http://www.w3.org/2000/svg"
              stroke-width="0.005">
              <g id="lines-drawing"></g>
            </svg>
          </div>
          <div id="marks"></div>
          <div id="track-cont" style="width:100%; height: 100%;">
            <svg id="track" xmlns="http://www.w3.org/2000/svg" class="game-elem" style="height: 100%;">
            </svg>
          </div>
          <div id="boats"></div>
          <svg xmlns="http://www.w3.org/2000/svg" id="start-line-svg">
            <line id="start-line" stroke-dasharray="4 6" stroke-width="0.5" stroke="gray"></line>
          </svg>
        </div>
      </div>
      <img src="img/wind.svg" id="wind" class="game-elem" />
      <h3 class="game-elem" id="wind-label">+10ยบ</h3>
    </div>
    <div style="width: 300px;" id="controll-container" class="h-100">
      <div class="d-flex flex-column align-items-stretch h-100 p-1">
        <div>
          <div id="start-alert" class="alert alert-warning text-center">
            Start procedure
            <label style="width: 10px;"></label>
          </div>
          <div id="game-alert" class="alert alert-info text-center">
            Race:
            <span id="wind-scenario-name-inrace-alert"></span>
            <label style="width: 10px;"></label>
            <input type="image" class="btn btn-outline-primary btn-sm" id="btn-nowember" src="img/november.svg">
          </div>
        </div>
        <div id="create">
          <div class="input-group mb-3">
            <select id="select-wind" class="form-select"></select>
            <button id="edit-btn" class="btn btn-outline-primary" data-bs-toggle="modal"
              data-bs-target="#wind-editor-window" data-bs-placement="top" data-bs-title="Edit wind">
              &#9998;
            </button>
            <button id="add-wind-btn" class="btn btn-outline-primary" data-bs-toggle="modal"
              data-bs-target="#wind-editor-window" data-bs-placement="top" data-bs-title="Add custom wind">
              +
            </button>
          </div>
        </div>
        <div class="w-100 mb-2 input-group start-control-header">
          <button class="btn btn-outline-danger" id="btn-add-player">+</button>
          <button class="btn btn-outline-primary" id="btn-apply">Start!</button>
        </div>
        <div class="w-100 mb-2 input-group race-control-header">
          <button class="btn btn-outline-primary" id="back-btn">Back</button>
          <button class="btn btn-outline-primary" id="btn-done">Next</button>
        </div>
        <div class="flex-grow-1 flex-shrink-1 overflow-auto">
          <div id="controlls" style="width: 100%;">
            <div id="last-controll" class="mb-2"></div>
          </div>
        </div>
        <div class="settings-container">
          <div class="w-100 m-0">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="set-show-tracks" />
              <label class="form-check-label" for="set-show-tracks">Show tracks</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="set-show-boats" />
              <label class="form-check-label" for="set-show-boats">Show boats</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="set-show-lanelines" />
              <label class="form-check-label" for="set-show-lanelines">Show lanelines</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" class="form-check-input" id="set-show-equal-lines" />
              <label class="form-check-label" for="set-show-equal-lines">Show equal lines</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" class="form-check-input" id="show-future-wind" />
              <label class="form-check-label" for="show-future-wind">Show future wind</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" class="form-check-input" id="full-screen" />
              <label class="form-check-label" for="full-screen">Fullscreen</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade  modal-lg" id="wind-editor-window" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">Wind Editor</h1>
          <div class="mr-0">
            <button class="btn btn-outline-primary" id="share-btn" data-bs-toggle="tooltip" data-bs-trigger="none"
              data-bs-title="Link copied to clipboard!">
              Share
            </button>
          </div>
        </div>
        <div class="modal-body">
          <div class="alert alert-warning" id="wind-readonly-text">
            This is predifined wind preset. It cannot be changed. Use 'Create Wind' button to
            create custom wind scenario.
          </div>
          <div class="mb-3">
            <label class="form-label">Scenario name</label>
            <input type="text" class="form-control" id="editor-wind-name" placeholder="i.e. &#34;pendulum 1&#34" />
          </div>
          <div class="mb-0">
            <label class="form-label">Wind change</label>
            <textarea class="form-control" id="editor-wind" rows="7" placeholder="i.e. 5, 10, 15, 20, 15...">
            </textarea>
          </div>
          <div class="mb-3">
            <div class="invalid-feedback" id="wind-valid"></div>
          </div>
          <div class="mb-3">
            <div class="row">
              <div class="col">
                <label class="form-label">Map width</label>
                <input type="number" value="40" min="5" max="200" class="form-control" id="map-width" />
              </div>
              <div class="col">
                <label class="form-label">Map height</label>
                <input type="number" value="30" min="5" max="200" class="form-control" id="map-height" />
              </div>
              <div class="col">
                <label class="form-label">Start line size</label>
                <input type="number" value="15" min="5" max="200" class="form-control" id="start-line-size" />
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="editor-save" data-bs-dismiss="modal">
            Save changes
          </button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" style="position: absolute; left: 10px;" id="delete-btn"
            data-bs-dismiss="modal">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade modal-lg" id="add-wind-url-window">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">Add wind?</h1>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Scenario name</label>
            <input type="text" class="form-control" id="add-wind-name" readonly />
          </div>
          <div class="mb-0">
            <label class="form-label">Wind change</label>
            <textarea class="form-control" id="add-wind-text" rows="7" readonly></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="load-wind-save" data-bs-dismiss="modal">
            Add wind
          </button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal modal fade" id="help-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Help</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <table class="table table-borderless">
              <tbody>
                <tr>
                  <th class="text-center" colspan="1">Keyboard shortcuts</th>
                </tr>
                <tr>
                  <td class="text-end"><kbd>Space</kbd></th>
                  <td>Next turn</td>
                </tr>
                <tr>
                  <td class="text-end"><kbd>Backspace</kbd></th>
                  <td>Previous turn</td>
                </tr>
                <tr>
                  <td class="text-end"><kbd>1</kbd> - <kbd>9</kbd></th>
                  <td>Change player turn selection</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <button type="button" class="btn btn-primary" id="liveToastBtn">Show live toast</button>

  <div class="toast-container position-fixed top-0 start-0 p-3">
    <div id="too-many-boats-alert" class="toast" data-bs-autohide="true" data-bs-delay="4000">
      <div class="toast-header">
        <strong class="me-auto">Too many boats</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body">
        You can't add more players.
      </div>
    </div>
  </div>
</body>